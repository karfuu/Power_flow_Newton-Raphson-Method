printf('\t\tNewton-Raphson load flow for 10 bus system:\n\n');
Y11 = 53.852; Y12 = 22.361; Y13 = 31.623;
Y21 = 22.361; Y22 = 58.138; Y23 = 35.777;
Y31 = 31.623; Y32 = 35.777; Y33 = 129.984; Y34 = 27.597; Y35 = 24.254; Y36 = 11.684;
Y43 = 27.597; Y44 = 66.527; Y48 = 34.483; Y410 = 5.725;
Y53 = 24.254; Y55 = 38.347; Y58 = 17.150;
Y63 = 11.684; Y66 = 17.472; Y67 = 5.793;
Y76 = 5.793; Y77 = 17.082; Y78 = 13.736;
Y84 = 34.483; Y85 = 17.150; Y87 = 13.736; Y88 = 158.005; Y89 = 94.072;
Y98 = 94.072; Y99 = 158.082; Y910 = 64.0184;
Y104 = 5.725; Y109 = 64.0184; Y1010 = 68.681;
t11 = -68.199*pi/180; t12 = 116.565*pi/180; t13 = 108.435*pi/180;
t21 = 116.565*pi/180; t22 = -63.435*pi/180; t23 = 116.565*pi/180;
t31 = 108.435*pi/180; t32 = 116.565*pi/180; t33 = -69.185*pi/180; t34 = 117.985*pi/180; t35 = 104.036*pi/180; t36 = 96.710*pi/180;
t43 = 117.985*pi/180; t44 = -53.866*pi/180; t48 = 136.397*pi/180; t410 = 103.241*pi/180;
t53 = 104.036*pi/180; t55 = -57.524*pi/180; t58 = 149.036*pi/180; 
t63 = 96.710*pi/180; t66 = -82.204*pi/180; t67 = 100.008*pi/180; 
t76 = 100.008*pi/180; t77 = -33.709*pi/180; t78 = 164.055*pi/180; 
t84 = 136.397*pi/180; t85 = 149.036*pi/180; t87 = 164.055*pi/180; t88 = -38.486*pi/180; t89 = 138.814*pi/180;
t98 = 138.814*pi/180; t99 = -40.626*pi/180; t910 = 140.194*pi/180;
t104 = 103.241*pi/180; t109 = 140.194*pi/180; t1010 = -42.681*pi/180;
% defining the known states:
d1 = 0; V1 = 1.04; V3 = 1.025; V6 = 1.025; V10 = 1.011; 
% defining the power injections:
P2 = 1; Q2 = 0.5; P3 = 1.85; P4 = 2; Q4 = 1; P5 = 0.3; Q5 = 0.2; P6 = 1.81; 
P7 = 1; Q7 = 0.1; P8 = 1; Q8 = 0.35; P9 = 1.66; Q9 = 0.05; P10 = 1.80;
% defining the inital values of unkowns:
d2 = 0; d3 = 0; d4 = 0; d5 = 0; d6 = 0; d7 = 0; d8 = 0; d9 = 0; d10 = 0;
V2 = 1; V4 =1; V5 = 1; V7 = 1; V8 = 1; V9 = 1;
X = [d2; d3; d4; d5; d6; d7; d8; d9; d10; V2; V4; V5; V7; V8; V9];
disp(X');

for m=1:10
  fP2 = V2*V1*Y21*cos(t21+d1-d2) +V2^2*Y22*cos(t22) +V2*V3*Y23*cos(t23+d3-d2) +P2;
  fP3 = V3*V1*Y31*cos(t31+d1-d3) +V3*V2*Y32*cos(t32+d2-d3) +V3^2*Y33*cos(t33) +V3*V4*Y34*cos(t34+d4-d3) +V3*V5*Y35*cos(t35+d5-d3) +V3*V6*Y36*cos(t36+d6-d3)-P3;
  fP4 = V4*V3*Y43*cos(t43+d3-d4) +V4^2*Y44*cos(t44) +V4*V8*Y48*cos(t48+d8-d4) +V4*V10*Y410*cos(t410+d10-d4)+P4;
  fP5 = V5*V3*Y53*cos(t53+d3-d5) +V5^2*Y55*cos(t55) +V5*V8*Y58*cos(t58+d8-d5) +P5;
  fP6 = V6*V3*Y63*cos(t63+d3-d6) +V6^2*Y66*cos(t66) +V6*V7*Y67*cos(t67+d7-d6) -P6;
  fP7 = V7*V6*Y76*cos(t76+d6-d7) +V7^2*Y77*cos(t77) +V7*V8*Y78*cos(t78+d8-d7) +P7;
  fP8 = V8*V4*Y84*cos(t84+d4-d8) +V8*V5*Y85*cos(t85+d5-d8) +V8*V7*Y87*cos(t87+d7-d8) +V8^2*Y88*cos(t88) +V8*V9*Y89*cos(t89+d9-d8) +P8;
  fP9 = V9*V8*Y98*cos(t98+d8-d9) +V9^2*Y99*cos(t99) +V9*V10*Y910*cos(t910+d10-d9) +P9;
  fP10 = V10*V4*Y104*cos(t104+d4-d10) +V10*V9*Y109*cos(t109+d9-d10) +V10^2*Y1010*cos(t1010) -P10;
  fQ2 = -Y21*V2*V1*sin(t21+d1-d2) -Y22*V2^2*sin(t22) -Y23*V2*V3*sin(t23+d3-d2) +Q2;
  fQ4 = -Y43*V4*V3*sin(t43+d3-d4) -Y44*V4^2*sin(t44) -Y48*V4*V8*sin(t48+d8-d4) -Y410*V4*V10*sin(t410+d10-d4)+Q4;
  fQ5 = -Y53*V5*V3*sin(t53+d3-d5) -Y55*V5^2*sin(t55) -Y58*V5*V8*sin(t58+d8-d5) +Q5;
  fQ7 = -Y76*V7*V6*sin(t76+d6-d7) -Y77*V7^2*sin(t77) -Y78*V7*V8*sin(t78+d8-d7) +Q7;
  fQ8 = -Y84*V8*V4*sin(t84+d4-d8) -Y85*V8*V5*sin(t85+d5-d8) -Y87*V8*V7*sin(t87+d7-d8) -Y88*V8^2*sin(t88) -Y89*V8*V9*sin(t89+d9-d8) +Q8;
  fQ9 = -Y98*V9*V8*sin(t98+d8-d9) -Y99*V9^2*sin(t99) -Y910*V9*V10*sin(t910+d10-d9) +Q9;
  fx = [fP2; fP3; fP4; fP5; fP6; fP7; fP8; fP9; fP10; fQ2; fQ4; fQ5; fQ7; fQ8; fQ9];
  
  J11 = V2*V1*Y21*sin(t21+d1-d2) +V2*V3*Y23*sin(t23+d3-d2);
  J12 = -V2*V3*Y23*sin(t23+d3-d2);
  J110 = V1*Y21*cos(t21+d1-d2) +2*V2*Y22*cos(t22) +V3*Y23*cos(t23+d3-d2);
  
  J21 = -V3*V2*Y32*sin(t32+d2-d3);
  J22 = V3*V1*Y31*sin(t31+d1-d3) +V3*V2*Y32*sin(t32+d2-d3) +V3*V4*Y34*sin(t34+d4-d3) +V3*V5*Y35*sin(t35+d5-d3) +V3*V6*Y36*sin(t36+d6-d3);
  J23 = -V3*V4*Y34*sin(t34+d4-d3);
  J24 = -V3*V5*Y35*sin(t35+d5-d3);
  J25 = -V3*V6*Y36*sin(t36+d6-d3);
  J210 = V3*Y32*cos(t32+d2-d3);
  J211 = V3*Y34*cos(t34+d4-d3);
  J212 = V3*Y35*cos(t35+d5-d3);
  
  J32 = -V4*V3*Y43*sin(t43+d3-d4);
  J33 = V4*V3*Y43*sin(t43+d3-d4) +V4*V8*Y48*sin(t48+d8-d4) +V4*V10*Y410*sin(t410+d10-d4);
  J37 = -V4*V8*Y48*sin(t48+d8-d4);
  J39 = -V4*V10*Y410*sin(t410+d10-d4);
  J311 = V3*Y43*cos(t43+d3-d4) +2*V4*Y44*cos(t44) +V8*Y48*cos(t48+d8-d4) +V10*Y410*cos(t410+d10-d4);
  J314 = V4*Y48*cos(t48+d8-d4);
  
  J42 = -V5*V3*Y53*sin(t53+d3-d5);
  J44 = V5*V3*Y53*sin(t53+d3-d5) +V5*V8*Y58*sin(t58+d8-d5);
  J47 = -V5*V8*Y58*sin(t58+d8-d5);
  J412 = V3*Y53*cos(t53+d3-d5) +2*V5*Y55*cos(t55) +V8*Y58*cos(t58+d8-d5);
  J414 = V5*Y58*cos(t58+d8-d5);
  
  J52 = -V6*V3*Y63*sin(t63+d3-d6);
  J55 = V6*V3*Y63*sin(t63+d3-d6) +V6*V7*Y67*sin(t67+d7-d6);
  J56 = -V6*V7*Y67*sin(t67+d7-d6);
  J513 = V6*Y67*cos(t67+d7-d6);
  
  J65 = -V7*V6*Y76*sin(t76+d6-d7);
  J66 = V7*V6*Y76*sin(t76+d6-d7) +V7*V8*Y78*sin(t78+d8-d7);
  J67 = -V7*V8*Y78*sin(t78+d8-d7);
  J613 = V6*Y76*cos(t76+d6-d7) +2*V7*Y77*cos(t77) +V8*Y78*cos(t78+d8-d7);
  J614 = V7*Y78*cos(t78+d8-d7);
  
  J73 = -V8*V4*Y84*sin(t84+d4-d8);
  J74 = -V8*V5*Y85*sin(t85+d5-d8);
  J76 = -V8*V7*Y87*sin(t87+d7-d8);
  J77 = V8*V4*Y84*sin(t84+d4-d8) +V8*V5*Y85*sin(t85+d5-d8) +V8*V7*Y87*sin(t87+d7-d8) +V8*V9*Y89*sin(t89+d9-d8);
  J78 = -V8*V9*Y89*sin(t89+d9-d8);
  J711 = V8*Y84*cos(t84+d4-d8);
  J712 = V8*Y85*cos(t85+d5-d8);
  J713 = V8*Y87*cos(t87+d7-d8);
  J714 = V4*Y84*cos(t84+d4-d8) +V5*Y85*cos(t85+d5-d8) +V7*Y87*cos(t87+d7-d8) +2*V8*Y88*cos(t88) +V9*Y89*cos(t89+d9-d8);
  J715 = V8*Y89*cos(t89+d9-d8);
  
  J87 = -V9*V8*Y98*sin(t98+d8-d9);
  J88 = V9*V8*Y98*sin(t98+d8-d9) +V9*V10*Y910*sin(t910+d10-d9);
  J89 = -V9*V10*Y910*sin(t910+d10-d9);
  J814 = V9*Y98*cos(t98+d8-d9);
  J815 = V8*Y98*cos(t98+d8-d9) +2*V9*Y99*cos(t99) +V10*Y910*cos(t910+d10-d9);
   
  J93 = -V10*V4*Y104*sin(t104+d4-d10);
  J98 = -V10*V9*Y109*sin(t109+d9-d10);
  J99 = V10*V4*Y104*sin(t104+d4-d10) +V10*V9*Y109*sin(t109+d9-d10);
  J911 = V10*Y104*cos(t104+d4-d10);
  J915 = V10*Y109*cos(t109+d9-d10);
  
  j11 = V2*V1*Y21*cos(t21+d1-d2) +V2*V3*Y23*cos(t23+d3-d2);
  j12 = -V2*V3*Y23*cos(t23+d3-d2);
  j110 = -V1*Y21*sin(t21+d1-d2) -2*V2*Y22*sin(t22)-V3*Y23*sin(t23+d3-d2);
  
  j22 =  -V4*V3*Y43*cos(t43+d3-d4);
  j23 = V4*V3*Y43*cos(t43+d3-d4) +V4*V8*Y48*cos(t48+d8-d4) +V4*V10*Y410*cos(t410+d10-d4);
  j27 = -V4*V8*Y48*cos(t48+d8-d4);
  j29 = -V4*V10*Y410*cos(t410+d10-d4);
  j211 = -V3*Y43*sin(t43+d3-d4) -2*V4*Y44*sin(t44) -V8*Y48*sin(t48+d8-d4) -V10*Y410*sin(t410+d10-d4);
  j214 = -V4*Y48*sin(t48+d8-d4);
  
  j32 = -V5*V3*Y53*cos(t53+d3-d5);
  j34 = V5*V3*Y53*cos(t53+d3-d5) +V5*V8*Y58*cos(t58+d8-d5);
  j37 = -V5*V8*Y58*cos(t58+d8-d5);
  j312 = -V3*Y53*sin(t53+d3-d5) -2*V5*Y55*sin(t55) -V8*Y58*sin(t58+d8-d5);
  j314 = -V5*Y58*sin(t58+d8-d5);
  
  j45 = -V7*V6*Y76*cos(t76+d6-d7);
  j46 = V7*V6*Y76*cos(t76+d6-d7) +V7*V8*Y78*cos(t78+d8-d7);
  j47 = -V7*V8*Y78*cos(t78+d8-d7);
  j413 = -V6*Y76*sin(t76+d6-d7) -2*V7*Y77*sin(t77) -V8*Y78*sin(t78+d8-d7);
  j414 = -V7*Y78*sin(t78+d8-d7);
  
  j53 = -V8*V4*Y84*cos(t84+d4-d8);
  j54 = -V8*V5*Y85*cos(t85+d5-d8);
  j56 = -V8*V7*Y87*cos(t87+d7-d8);
  j57 = V8*V4*Y84*cos(t84+d4-d8) +V8*V5*Y85*cos(t85+d5-d8) +V8*V7*Y87*cos(t87+d7-d8) +V8*V9*Y89*cos(t89+d9-d8);
  j58 = -V8*V9*Y89*cos(t89+d9-d8);
  j511 = -V8*Y84*sin(t84+d4-d8);
  j512 = -V8*Y85*sin(t85+d5-d8);
  j513 = -V8*Y87*sin(t87+d7-d8);
  j514 = -V4*Y84*sin(t84+d4-d8) -V5*Y85*sin(t85+d5-d8) -V7*Y87*sin(t87+d7-d8) -2*V8*Y88*sin(t88)-V9*Y89*sin(t89+d9-d8);
  j515 = -V8*Y89*sin(t89+d9-d8);
  
  j67 = -V9*V8*Y98*cos(t98+d8-d9);
  j68 = V9*V8*Y98*cos(t98+d8-d9) +V9*V10*Y910*cos(t910+d10-d9);
  j69 = -V9*V10*Y910*cos(t910+d10-d9);
  j614 = -V9*Y98*sin(t98+d8-d9);
  j615 = -V8*Y98*sin(t98+d8-d9) -2*V9*Y99*sin(t99) -V10*Y910*sin(t910+d10-d9);
  
  J = [J11 J12 0 0 0 0 0 0 0 J110 0 0 0 0 0;
       J21 J22 J23 J24 J25 0 0 0 0 J210 J211 J212 0 0 0;
       0 J32 J33 0 0 0 J37 0 J39 0 J311 0 0 J314 0;
       0 J42 0 J44 0 0 J47 0 0 0 0 J412 0 J414 0;
       0 J52 0 0 J55 J56 0 0 0 0 0 0 J513 0 0;
       0 0 0 0 J65 J66 J67 0 0 0 0 0 J613 J614 0;
       0 0 J73 J74 0 J76 J77 J78 0 0 J711 J712 J713 J714 J715;
       0 0 0 0 0 0 J87 J88 J89 0 0 0 0 J814 J815;
       0 0 J93 0 0 0 0 J98 J99 0 J911 0 0 0 J915;
       j11 j12 0 0 0 0 0 0 0 j110 0 0 0 0 0;
       0 j22 j23 0 0 0 j27 0 j29 0 j211 0 0 j214 0;
       0 j32 0 j34 0 0 j37 0 0 0 0 j312 0 j314 0;
       0 0 0 0 j45 j46 j47 0 0 0 0 0 j413 j414 0;
       0 0 j53 j54 0 j56 j57 j58 0 0 j511 j512 j513 j514 j515;
       0 0 0 0 0 0 j67 j68 j69 0 0 0 0 j614 j615];
       
   X = X - J\fx; %iteration    
   d2 = X(1); d3 = X(2); d4 = X(3); d5 = X(4); d6 = X(5); d7 = X(6); d8 = X(7); d9 = X(8); d10 = X(9);
   V2 = X(10); V4 = X(11); V5 = X(12); V7 = X(13); V8 = X(14); V9 = X(15);
   printf('iteration :%d \n', m);
   disp(X)
   disp('')
   
 end
printf(' V1 = %f \t\tdelta 1 = %d \n ', V1, d1);
printf('V2 = %f \t\tdelta 2 = %f \n ', X(10), X(1)*180/pi);
printf('V3 = %f \t\tdelta 3 = %f \n ', V3, X(2)*180/pi);
printf('V4 = %f \t\tdelta 4 = %f \n ', X(11), X(3)*180/pi);
printf('V5 = %f \t\tdelta 5 = %f \n ', X(12), X(4)*180/pi);
printf('V6 = %f \t\tdelta 6 = %f \n ', V6, X(5)*180/pi);
printf('V7 = %f \t\tdelta 7 = %f \n ', X(13), X(6)*180/pi);
printf('V8 = %f \t\tdelta 8 = %f \n ', X(14), X(7)*180/pi);
printf('V9 = %f \t\tdelta 9 = %f \n ', X(15), X(8)*180/pi);
printf('V10 = %f \tdelta 10 = %f \n\n ', V10, X(9)*180/pi);

disp(' power slack bus & PV bus')
P1 = V1^2*Y11*cos(t11) +V1*X(10)*Y12*cos(t12+X(1)-d1) +V1*V3*Y13*cos(t13+X(2)-d1)
Q1 = -V1^2*Y11*sin(t11) -V1*X(10)*Y12*sin(t12+X(1)-d1) -V1*V3*Y13*sin(t13+X(2)-d1)
Q3 = -V3*V1*Y31*sin(t31+d1-X(2)) -V3*V2*Y32*sin(t32+X(1)-X(2)) -V3^2*Y33*sin(t33) -V3*V4*Y34*sin(t34+X(3)-X(2)) -V3*V5*Y35*sin(t35+X(4)-X(2)) -V3*V6*Y36*sin(t36+X(5)-X(2))
Q6 = -V6*V3*Y63*sin(t63+X(2)-X(5)) -V6*V7*Y67*sin(t67+X(6)-X(5)) -V6^2*Y66*sin(t66)
Q10 = -V10*V4*Y104*sin(t104+X(3)-X(9)) -V10*V9*Y109*sin(t109+X(8)-X(9)) -V10^2*Y1010*sin(t1010)
% voltage A + Bi form;
v1 = V1; v2 = X(10)*cos(X(1))+X(10)*sin(X(1))*i; v3 = V3*cos(X(2))+V3*sin(X(2))*i; v4 = X(11)*cos(X(3))+X(11)*sin(X(3))*i; v5 = X(12)*cos(X(4))+X(12)*sin(X(4))*i;
v6 = V6*cos(X(5))+V6*sin(X(5))*i; v7 = X(13)*cos(X(6))+X(13)*sin(X(6))*i; v8 = X(14)*cos(X(7))+X(14)*sin(X(7))*i; v9 = X(15)*cos(X(8))+X(15)*sin(X(8))*i; v10 = V10*cos(X(9))+V10*sin(X(9))*i;
disp(' line currents')
I12 = [Y12*cos(t12)+Y12*sin(t12)*i]*(v2-v1)
I21 = -I12
I13 = [Y13*cos(t13)+Y13*sin(t13)*i]*(v3-v1)
I31 = -I13
I32 = [Y32*cos(t32)+Y32*sin(t32)*i]*(v2-v3)
I23 = -I32
I34 = [Y34*cos(t34)+Y34*sin(t34)*i]*(v4-v3)
I43 = -I34
I35 = [Y35*cos(t35)+Y35*sin(t35)*i]*(v5-v3)
I53 = -I35
I36 = [Y36*cos(t36)+Y36*sin(t36)*i]*(v6-v3)
I63 = -I36
I67 = [Y67*cos(t67)+Y67*sin(t67)*i]*(v7-v6)
I76 = -I67
I58 = [Y58*cos(t58)+Y58*sin(t58)*i]*(v8-v5)
I85 = -I58
I84 = [Y84*cos(t84)+Y84*sin(t84)*i]*(v4-v8)
I48 = -I84
I87 = [Y87*cos(t87)+Y87*sin(t87)*i]*(v7-v8)
I78 = -I87
I98 = [Y98*cos(t98)+Y98*sin(t98)*i]*(v8-v9)
I89 = -I98
I104 = [Y104*cos(t104)+Y104*sin(t104)*i]*(v4-v10)
I410 = -I104
I109 = [Y109*cos(t109)+Y109*sin(t109)*i]*(v9-v10)
I910 = -I109


disp('line flows')
S12 = v1*conj(I12), S21 = v2*conj(I21), S13 = v1*conj(I13), S31 = v3*conj(I31), S23 = v2*conj(I23), S32 = v3*conj(I32), S36 = v3*conj(I36),
S34 = v3*conj(I34), S43 = v4*conj(I43), S35 = v3*conj(I35), S53 = v5*conj(I53), S67 = v6*conj(I67), S76 = v7*conj(I76), S63 = v6*conj(I63),
S58 = v5*conj(I58), S85 = v8*conj(I85), S84 = v8*conj(I84), S48 = v4*conj(I48), S87 = v8*conj(I87), S78 = v7*conj(I78),
S98 = v9*conj(I98), S89 = v8*conj(I89), S104 = v10*conj(I104), S410 = v4*conj(I410), S109 = v10*conj(I109), S910 = v9*conj(I910),

disp('line losses')
SL12 = S12 + S21;
printf('\n \tSL12 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL12),imag(SL12), abs(SL12), angle(SL12)*180/pi]);

SL13 = S13 + S31;
printf('\n \tSL13 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL13),imag(SL13), abs(SL13), angle(SL13)*180/pi]);

SL23 = S23 + S32;
printf('\n \tSL23 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL23),imag(SL23), abs(SL23), angle(SL23)*180/pi]);

SL34 = S34 + S43;
printf('\n \tSL34 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL34),imag(SL34), abs(SL34), angle(SL34)*180/pi]);

SL35 = S35 + S53;
printf('\n \tSL35 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL35),imag(SL35), abs(SL35), angle(SL35)*180/pi]);

SL36 = S36 + S63;
printf('\n \tSL36 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL36),imag(SL36), abs(SL36), angle(SL36)*180/pi]);

SL58 = S58 + S85;
printf('\n \tSL58 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL58),imag(SL58), abs(SL58), angle(SL58)*180/pi]);

SL67 = S67 + S76;
printf('\n \tSL67 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL67),imag(SL67), abs(SL67), angle(SL67)*180/pi]);

SL84 = S84 + S48;
printf('\n \tSL84 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL84),imag(SL84), abs(SL84), angle(SL84)*180/pi]);

SL87 = S87 + S78;
printf('\n \tSL87 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL87),imag(SL87), abs(SL87), angle(SL87)*180/pi]);

SL98 = S98 + S89;
printf('\n \tSL98 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL98),imag(SL98), abs(SL98), angle(SL98)*180/pi]);

SL104 = S104 + S410;
printf('\n \tSL104 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n',[real(SL104),imag(SL104), abs(SL104), angle(SL104)*180/pi]);

SL109 = S109 + S910;
printf('\n \tSL109 \t\t\t absolute\t\t angle\n ');
printf('%.7f + %.7fi \t %.7f \t\t %.7f \t\t\n\n',[real(SL109),imag(SL109), abs(SL109), angle(SL109)*180/pi]);
E = 0.000;
printf('\t\tPower Flow Solution by Newton-Raphson Method\n');
printf('\t\t\t No. of iterations = 10\n\n');
printf('Bus\tVoltage \tAngle\t    ------Load--------    -----Generation-----\n');
printf('N0.\tMag.    \tDegree\t     MW          Mvar      MW             Mvar\n ');
printf('1  \t%.4f    \t0.0000\t     %.3f      %.3f    %.3f         %.3f\n ',V1, E,E, P1*100, Q1*100);
printf('2  \t%.4f    \t%.4f    %.3f     %.3f      0.000          0.000\n ' ,V2, X(1)*180/pi, P2*100, Q2*100);
printf('3  \t%.4f    \t%.4f      %.3f      %.3f    %.3f         %.3f\n ',V3, X(2)*180/pi, E,E, P3*100, Q3*100);
printf('4  \t%.4f    \t%.4f    %.3f    %.3f      %.3f          %.3f\n ',V4, X(3)*180/pi, P4*100, Q4*100, E, E);
printf('5  \t%.4f    \t%.4f     %.3f     %.3f      %.3f          %.3f\n ',V5, X(4)*180/pi, P5*100, Q5*100, E, E);
printf('6  \t%.4f    \t %.4f      %.3f      %.3f    %.3f         %.3f\n ',V6, X(5)*180/pi, E, E, P6*100, Q6*100);
printf('7  \t%.4f    \t%.4f    %.3f     %.3f      %.3f          %.3f\n ',V7, X(6)*180/pi, P7*100, Q7*100, E, E);
printf('8  \t%.4f    \t%.4f    %.3f     %.3f      %.3f          %.3f\n ',V8, X(7)*180/pi, P8*100, Q8*100, E, E);
printf('9  \t%.4f    \t%.4f    %.3f      %.3f      %.3f          %.3f\n ',V9, X(8)*180/pi, P9*100, Q9*100, E, E);
printf('10 \t%.4f    \t%.4f      %.3f      %.3f    %.3f        %.3f\n\n ',V10, X(9)*180/pi, E, E, P10*100, Q10*100);

printf('\t\t\tLine Flow and Losses\n\n');
printf('---Line---\t===Power at bus  &  Line Flow===\t---Line Loss---\n ');
printf('from  to \tMW           Mvar          MVA\t\tMW        Mvar\n');
printf('  1       \t%.3f      %.3f        %.3f\t\t                  \n', P1*100,Q1*100, sqrt(P1^2+Q1^2)*100);
printf('        2  \t %.3f      %.3f         %.3f \t%.3f      %.3f\n', real(S12)*100, imag(S12)*100, abs(S12)*100, real(SL12)*100, imag(SL12)*100);
printf('        3  \t %.3f      %.3f         %.3f \t%.3f      %.3f\n', real(S13)*100, imag(S13)*100, abs(S13)*100, real(SL13)*100, imag(SL13)*100);
printf('  2       \t%.3f      %.3f        %.3f\t\t                  \n', P2*100,Q2*100, sqrt(P2^2+Q2^2)*100);
printf('        1  \t%.3f     %.3f         %.3f \t%.3f      %.3f\n', real(S21)*100, imag(S21)*100, abs(S21)*100, real(SL12)*100, imag(SL12)*100);
printf('        3  \t%.3f     %.3f         %.3f \t%.3f      %.3f\n', real(S23)*100, imag(S23)*100, abs(S23)*100, real(SL23)*100, imag(SL23)*100);
printf('  3       \t%.3f      %.3f        %.3f\t\t                  \n', P3*100,Q3*100, sqrt(P3^2+Q3^2)*100);
printf('        2  \t %.3f      %.3f         %.3f \t%.3f      %.3f\n', real(S32)*100, imag(S32)*100, abs(S32)*100, real(SL23)*100, imag(SL23)*100);
printf('        4  \t%.3f      %.3f        %.3f  \t%.3f     %.3f\n', real(S34)*100, imag(S34)*100, abs(S34)*100, real(SL34)*100, imag(SL34)*100);
printf('        5  \t%.3f      %.3f        %.3f  \t%.3f      %.3f\n', real(S35)*100, imag(S35)*100, abs(S35)*100, real(SL35)*100, imag(SL35)*100);
printf('        6  \t%.3f      %.3f         %.3f \t%.3f      %.3f\n', real(S36)*100, imag(S36)*100, abs(S36)*100, real(SL36)*100, imag(SL36)*100);
printf('  4       \t%.3f     %.3f        %.3f \t\t                  \n', P4*100,Q4*100, sqrt(P4^2+Q4^2)*100);
printf('        3      %.3f     %.3f        %.3f   \t%.3f     %.3f\n', real(S43)*100, imag(S43)*100, abs(S43)*100, real(SL34)*100, imag(SL34)*100);
printf('        8  \t %.3f     %.3f         %.3f  \t%.3f      %.3f\n', real(S48)*100, imag(S48)*100, abs(S48)*100, real(SL84)*100, imag(SL84)*100);
printf('       10  \t  %.3f     %.3f         %.3f  \t%.3f      %.3f\n', real(S410)*100, imag(S410)*100, abs(S410)*100, real(SL104)*100, imag(SL104)*100);
printf('  5       \t %.3f      %.3f         %.3f \t\t                  \n', P5*100,Q5*100, sqrt(P5^2+Q5^2)*100);
printf('        3      %.3f      %.3f        %.3f  \t%.3f      %.3f\n', real(S53)*100, imag(S53)*100, abs(S53)*100, real(SL35)*100, imag(SL35)*100);
printf('        8  \t %.3f     %.3f         %.3f  \t%.3f      %.3f\n', real(S58)*100, imag(S58)*100, abs(S58)*100, real(SL58)*100, imag(SL58)*100);
printf('  6       \t%.3f      %.3f        %.3f  \t\t                  \n', P6*100,Q6*100, sqrt(P6^2+Q6^2)*100);
printf('        3  \t %.3f      %.3f         %.3f \t%.3f      %.3f\n', real(S63)*100, imag(S63)*100, abs(S63)*100, real(SL36)*100, imag(SL36)*100);
printf('        7  \t %.3f      %.3f         %.3f \t%.3f     %.3f\n', real(S67)*100, imag(S67)*100, abs(S67)*100, real(SL67)*100, imag(SL67)*100);
printf('  7       \t%.3f      %.3f        %.3f  \t\t                  \n', P7*100,Q7*100, sqrt(P7^2+Q7^2)*100);
printf('        6  \t%.3f     %.3f         %.3f \t%.3f     %.3f\n', real(S76)*100, imag(S76)*100, abs(S76)*100, real(SL67)*100, imag(SL67)*100);
printf('        8  \t %.3f       %.3f          %.3f \t%.3f      %.3f\n', real(S78)*100, imag(S78)*100, abs(S78)*100, real(SL87)*100, imag(SL87)*100);
printf('  8       \t%.3f      %.3f        %.3f   \t\t                  \n', P8*100,Q8*100, sqrt(P8^2+Q8^2)*100);
printf('        4 \t%.3f      %.3f         %.3f  \t%.3f      %.3f\n', real(S84)*100, imag(S84)*100, abs(S84)*100, real(SL84)*100, imag(SL84)*100);
printf('        5  \t%.3f      %.3f         %.3f  \t%.3f      %.3f\n', real(S85)*100, imag(S85)*100, abs(S85)*100, real(SL58)*100, imag(SL58)*100);
printf('        7  \t  %.3f      %.3f          %.3f\t%.3f      %.3f\n', real(S87)*100, imag(S87)*100, abs(S87)*100, real(SL87)*100, imag(SL87)*100);
printf('        9  \t %.3f     %.3f         %.3f  \t%.3f      %.3f\n', real(S89)*100, imag(S89)*100, abs(S89)*100, real(SL98)*100, imag(SL98)*100);
printf('  9       \t%.3f       %.3f        %.3f\t\t                  \n', P9*100,Q9*100, sqrt(P9^2+Q9^2)*100);
printf('        8  \t  %.3f      %.3f         %.3f  \t%.3f      %.3f\n', real(S98)*100, imag(S98)*100, abs(S98)*100, real(SL98)*100, imag(SL98)*100);
printf('       10      %.3f     %.3f        %.3f  \t%.3f      %.3f\n', real(S910)*100, imag(S910)*100, abs(S910)*100, real(SL109)*100, imag(SL109)*100);
printf(' 10       \t%.3f     %.3f        %.3f\t\t                  \n', P10*100,Q10*100, sqrt(P10^2+Q10^2)*100);
printf('        4  \t %.3f      %.3f         %.3f  \t%.3f      %.3f\n', real(S104)*100, imag(S104)*100, abs(S104)*100, real(SL104)*100, imag(SL104)*100);
printf('        9  \t%.3f      %.3f        %.3f   \t%.3f      %.3f\n\n', real(S109)*100, imag(S109)*100, abs(S109)*100, real(SL109)*100, imag(SL109)*100);


disp('good luck ^0^')

------------------------------------------------------10 iteration--------------------------------------------------------------------------------
                                         Newton-Raphson load flow for 10 bus system:
 
   0   0   0   0   0   0   0   0   0   1   1   1   1   1   1
iteration :1
  -0.023612
  -0.020293
  -0.080698
  -0.061917
   0.052519
  -0.096074
  -0.091274
  -0.096552
  -0.088562
   1.015873
   0.972753
   1.011204
   0.971254
   0.975460
   0.981561

iteration :2
  -0.025973
  -0.024428
  -0.088518
  -0.068030
   0.048145
  -0.103252
  -0.100593
  -0.107096
  -0.100345
   1.015486
   0.970257
   1.010282
   0.966220
   0.973150
   0.980095

 iteration :3
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

iteration :4
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

  iteration :5
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

iteration :6
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

  iteration :7
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

iteration :8
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

  iteration :9
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085

iteration :10
  -0.025992
  -0.024459
  -0.088578
  -0.068079
   0.048109
  -0.103311
  -0.100670
  -0.107185
  -0.100445
   1.015483
   0.970243
   1.010279
   0.966190
   0.973135
   0.980085 

Matrix 15*15 last iteration
J =
Columns 1 through 11:

    54.1230   -33.2822          0          0          0          0          0          0          0    25.4179          0
   -33.3333   126.7184   -25.0114   -24.6085   -12.0553          0          0          0          0   -16.3496   -11.6455
          0   -23.3610    51.5797          0          0          0   -22.7374          0    -5.4813          0    36.0007
          0   -24.0772          0    33.2186          0          0    -9.1414          0          0          0          0
          0   -12.2633          0          0    17.9988    -5.7355          0          0          0          0          0
          0          0          0          0    -5.4347     8.9499    -3.5151          0          0          0          0
          0          0   -22.1672    -8.1991          0    -3.5807    93.4679   -59.5209          0          0   -24.5776
          0          0          0          0          0          0   -58.6411    98.9213   -40.2802          0          0
          0          0    -5.4508          0          0          0          0   -40.9371    46.3879          0    -1.3925
   -27.8114    16.7049          0          0          0          0          0          0          0    52.3130          0
          0    14.4048   -38.9294          0          0          0    23.3032          0     1.2213          0    51.1003
          0     7.1481          0   -21.3157          0          0    14.1676          0          0          0          0
          0          0          0          0     1.8378   -14.2653    12.4275          0          0          0          0
          0          0    23.8462    14.7330          0    12.4087  -118.1240    67.1360          0          0   -22.8470
          0          0          0          0          0          0    67.9058  -116.9092    49.0034          0          0

 Columns 12 through 15:

          0          0          0          0
    -4.9720          0          0          0
          0          0   -23.9465          0
    20.5050          0   -14.5588          0
          0    -0.1381          0          0
          0    12.6945   -12.7706          0
   -14.5831   -12.8430   119.3298   -68.5002
          0          0   -69.7805   115.8973
          0          0          0   -49.4406
          0          0          0          0
          0          0   -23.3651          0
    32.4847          0    -9.3938          0
          0     9.0561    -3.6122          0
    -8.1157    -3.7060    95.3289   -60.7303
          0          0   -60.2599   100.8293

 V1 = 1.040000          delta 1 = 0
 V2 = 1.015483          delta 2 = -1.489223
 V3 = 1.025000          delta 3 = -1.401400
 V4 = 0.970243          delta 4 = -5.075139
 V5 = 1.010279          delta 5 = -3.900631
 V6 = 1.025000          delta 6 = 2.756461
 V7 = 0.966190          delta 7 = -5.919295
 V8 = 0.973135          delta 8 = -5.767991
 V9 = 0.980085          delta 9 = -6.141264
 V10 = 1.011000         delta 10 = -5.755070

  power slack bus & PV bus
P1 = 1.7483
Q1 = 0.4594
Q3 = 0.9328
Q6 = 0.1880
Q10 = 1.2020

 line currents
I12 =  0.7764 - 0.2333i
I21 = -0.7764 + 0.2333i
I13 =  0.9051 - 0.2085i
I31 = -0.9051 + 0.2085i
I32 =  0.1952 - 0.2845i
I23 = -0.1952 + 0.2845i
I34 =  2.2351 - 0.6328i
I43 = -2.2351 + 0.6328i
I35 =  1.1258 - 0.1374i
I53 = -1.1258 + 0.1374i
I36 = -0.8617 - 0.1117i
I63 =  0.8617 + 0.1117i
I67 =  0.9128 - 0.2082i
I76 = -0.9128 + 0.2082i
I58 =  0.840820 + 0.077010i
I85 = -0.840820 - 0.077010i
I84 = -0.2405 - 0.3410i
I48 =  0.2405 + 0.3410i
I87 =  1.0164e-01 - 2.7516e-03i
I78 = -1.0164e-01 + 2.7516e-03i
I98 =  5.9826e-03 - 8.8638e-01i
I89 = -5.9826e-03 + 8.8638e-01i
I104 = -0.034903 - 0.240323i
I410 =  0.034903 + 0.240323i
I109 =  1.6886 - 1.1180i
I910 = -1.6886 + 1.1180i

line flows
S12 =  0.8075 + 0.2426i
S21 = -0.7943 - 0.2163i
S13 =  0.9413 + 0.2169i
S31 = -0.9327 - 0.1910i
S23 = -0.2057 - 0.2837i
S32 =  0.2071 + 0.2867i
S36 = -0.8802 + 0.1361i
S34 =  2.3062 + 0.5924i
S43 = -2.2144 - 0.4198i
S35 =  1.1571 + 0.1126i
S53 = -1.144196 - 0.061157i
S67 =  0.9243 + 0.2581i
S76 = -0.8980 - 0.1091i
S63 =  0.887710 - 0.071908i
S58 =  0.8422 - 0.1354i
S85 = -0.8066 + 0.1568i
S84 = -0.1995 + 0.3537i
S48 =  0.2032 - 0.3502i
S87 =  9.8680e-02 - 7.2765e-03i
S78 = -9.7956e-02 + 7.4833e-03i
S98 =  0.098766 + 0.863112i
S89 = -0.092481 - 0.857612i
S104 = -0.010746 + 0.245280i
S410 =  0.013105 - 0.235253i
S109 =  1.8119 + 0.9534i
S910 = -1.7627 - 0.9124i

line losses

        SL12                     absolute                angle
 0.0131451 + 0.0262903i          0.0293935               63.4350000

        SL13                     absolute                angle
 0.0086271 + 0.0258811i          0.0272811               71.5650000

        SL23                     absolute                angle
 0.0014882 + 0.0029763i          0.0033276               63.4350000

        SL34                     absolute                angle
 0.0917556 + 0.1726763i          0.1955408               62.0150000

        SL35                     absolute                angle
 0.0128630 + 0.0514529i          0.0530364               75.9640000

        SL36                     absolute                angle
 0.0075501 + 0.0641739i          0.0646165               83.2900000

        SL58                     absolute                angle
 0.0356450 + 0.0213872i          0.0415690               30.9640000

        SL67                     absolute                angle
 0.0262982 + 0.1490227i          0.1513253               79.9920000

        SL84                     absolute                angle
 0.0036564 + 0.0034824i          0.0050494               43.6030000

        SL87                     absolute                angle
 0.0007237 + 0.0002068i          0.0007527               15.9450000
                                                                                                         
        SL98                     absolute                angle
 0.0062856 + 0.0054999i          0.0083521               41.1860000

        SL104                    absolute                angle
 0.0023594 + 0.0100272i          0.0103010               76.7590000

        SL109                    absolute                angle
 0.0492168 + 0.0410146i          0.0640663               39.8060000

		 Power Flow Solution by Newton-Raphson Method
                         No. of iterations = 10

Bus     Voltage         Angle       ------Load--------    -----Generation-----
N0.     Mag.            Degree       MW          Mvar      MW             Mvar
 1      1.0400          0.0000       0.000      0.000    174.832         45.944
 2      1.0155          -1.4892    100.000     50.000      0.000          0.000
 3      1.0250          -1.4014      0.000      0.000    185.000         93.283
 4      0.9702          -5.0751    200.000    100.000      0.000          0.000
 5      1.0103          -3.9006     30.000     20.000      0.000          0.000
 6      1.0250           2.7565      0.000      0.000    181.000         18.802
 7      0.9662          -5.9193    100.000     10.000      0.000          0.000
 8      0.9731          -5.7680    100.000     35.000      0.000          0.000
 9      0.9801          -6.1413    166.000      5.000      0.000          0.000
 10     1.0110          -5.7551      0.000      0.000    180.000        120.196

 Total                             696.000    220.000    720.832        278.225


			 Line Flow and Losses

---Line---      ===Power at bus  &  Line Flow===        ---Line Loss---
 from  to       MW           Mvar          MVA          MW        Mvar
  1             174.832      45.944        180.768
        2        80.749      24.261         84.315      1.315      2.629
        3        94.132      21.686         96.597      0.863      2.588
  2             100.000      50.000        111.803
        1       -79.434     -21.632         82.327      1.315      2.629
        3       -20.566     -28.368         35.038      0.149      0.298
  3             185.000      93.283        207.188
	1       -93.269     -19.098         95.204      0.863      2.588
        2        20.714      28.665         35.366      0.149      0.298
        4       230.620      59.243        238.108      9.176     17.268
        5       115.706      11.261        116.253      1.286      5.145
        6       -88.016      13.608         89.062      0.755      6.417
  4             200.000     100.000        223.607
        3      -221.444     -41.975        225.388      9.176     17.268
        8        20.317     -35.019         40.486      0.366      0.348
       10         1.310     -23.525         23.562      0.236      1.003
  5              30.000      20.000         36.056
        3      -114.420      -6.116        114.583      1.286      5.145
        8        84.220     -13.541         85.302      3.565      2.139
  6             181.000      18.802        181.974
        3        88.771      -7.191         89.062      0.755      6.417
        7        92.432      25.815         95.969      2.630     14.902
  7             100.000      10.000        100.499
        6       -89.802     -10.912         90.463      2.630     14.902
        8        -9.796       0.748          9.824      0.072      0.021
  8             100.000      35.000        105.948
        4       -19.951      35.367         40.606      0.366      0.348
        5       -80.656      15.679         82.166      3.565      2.139
        7         9.868      -0.728          9.895      0.072      0.021
        9        -9.248     -85.761         86.258      0.629      0.550
  9             166.000       5.000        166.075
        8         9.877      86.311         86.874      0.629      0.550
       10      -176.273     -91.240        198.487      4.922      4.101
 10             180.000     120.196        216.442
        4        -1.075      24.528         24.552      0.236      1.003
        9       181.195      95.341        204.747      4.922      4.101
Total Loss                                             25.961     57.409

>>


    
     
     
  
  
  
  
  


